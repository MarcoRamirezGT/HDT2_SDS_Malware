import os
import sys
import difflib
from hashlib import sha256
import unittest
import hashlib
import pefile

pe = pefile.PE('/home/maquito/Desktop/DATA2/MALWR/sample_vg655_25th.exe')

pe.print_info()

print('Sections:')
for section in pe.sections:
    print(section.Name, hex(section.VirtualAddress), hex(section.Misc_VirtualSize), section.SizeOfRawData)
    
for entry in pe.DIRECTORY_ENTRY_IMPORT:
    print(entry.dll)
    for imp in entry.imports:
        print('\t', hex(imp.address), imp.name)
        
    
file = open('/home/maquito/Desktop/DATA2/MALWR/sample_vg655_25th.exe', 'rb')
data = file.read()    
print('SHA256 ES :')
sha256 = hashlib.sha256(data).hexdigest()
print(sha256)